# 🎓 APIの本質を学ぶプロジェクト

「APIって何？」「どうしてプログラムからプログラムを呼ぶの？」

そんな疑問を持つあなたのための、体験型学習プロジェクトです。

---

## 📚 目次

1. [APIって何？カレー作りで例えてみる](#apiって何カレー作りで例えてみる)
2. [このプロジェクトで何ができるの？](#このプロジェクトで何ができるの)
3. [準備するもの](#準備するもの)
4. [実際に動かしてみよう！](#実際に動かしてみよう)
5. [ブラウザでアクセスして感動体験](#ブラウザでアクセスして感動体験)
6. [JSONって何？お弁当箱に例えると](#jsonって何お弁当箱に例えると)
7. [APIの連鎖を見てみよう](#apiの連鎖を見てみよう)
8. [なぜプログラムからプログラムを呼ぶの？](#なぜプログラムからプログラムを呼ぶの)

---

## 🍛 APIって何？カレー作りで例えてみる

想像してください。あなたが**カレーを作る**としましょう。

### 全部自分でやる場合

1. 牧場に行って牛を育てる
2. 畑で野菜を育てる
3. スパイスを調合する
4. ようやくカレーが完成！

**めちゃくちゃ大変ですよね？** しかも何ヶ月もかかります。

### スーパーを使う場合（これがAPIの考え方！）

1. **肉屋さん（肉API）** に「牛肉ください」と頼む → 牛肉ゲット
2. **八百屋さん（野菜API）** に「じゃがいも、にんじん、玉ねぎください」と頼む → 野菜ゲット
3. **スパイス屋さん（スパイスAPI）** に「カレールーください」と頼む → ルーゲット
4. 家で組み合わせて → カレー完成！

**これなら1時間でできます。**

この「誰かに材料を頼んで、自分は組み合わせるだけ」というのが**APIの本質**です。

---

## 🎯 このプロジェクトで何ができるの？

このプロジェクトでは、**3つのAPI**を作ります。

### 1️⃣ 社員情報提供API（肉屋さん）

- 「ID番号1番の社員情報教えて！」と頼むと
- 「田中太郎さん、開発部、tanaka@example.com」と教えてくれる

### 2️⃣ お天気取得API（八百屋さん）

- 「今の東京の天気教えて！」と頼むと
- 「晴れ、気温25℃、湿度60%」と教えてくれる

### 3️⃣ 統合お助けAPI（カレーを作る人）

- **直接は何も持っていません**
- でも、上の2つのAPIに「教えて！」と頼んで
- 集めた情報を組み合わせて
- 「田中太郎さん、おはようございます！今日の天気は晴れですよ。今日も1日頑張りましょう！」という**素敵なメッセージ**を作ってくれます

**これがAPIオーケストレーション（複数のAPIを指揮して新しい価値を作ること）です！**

---

## 🛠️ 準備するもの

### 必要なもの

1. **Java 17以上**
   - Javaがインストールされているか確認：ターミナルで `java -version` を実行
   - なければ [Adoptium](https://adoptium.net/) からダウンロード

2. **Maven**
   - Mavenがインストールされているか確認：ターミナルで `mvn -version` を実行
   - なければ [Maven公式サイト](https://maven.apache.org/download.cgi) からダウンロード

3. **テキストエディタ**
   - VSCode、IntelliJ IDEA、Eclipseなど、何でもOK

4. **ブラウザ**
   - Chrome、Firefox、Safari、Edgeなど、普段使っているもので大丈夫

---

## 🚀 実際に動かしてみよう！

### ステップ1：プロジェクトをダウンロード

```bash
git clone https://github.com/ikdrn/API.git
cd API
```

### ステップ2：アプリを起動

```bash
mvn spring-boot:run
```

**ちょっと待ってください！** 初回は依存ライブラリをダウンロードするので、1〜2分かかります。☕コーヒーでも淹れて待ちましょう。

### ステップ3：起動完了の合図

ターミナルにこんなメッセージが出たら成功です：

```
🎉 APIサーバーが起動しました！
========================================
試しにブラウザで以下にアクセスしてみてください：
📋 社員情報: http://localhost:8080/api/internal/employees/1
☀️  天気情報: http://localhost:8080/api/internal/weather
💌 朝の挨拶: http://localhost:8080/api/v1/morning-check/1
========================================
```

**おめでとうございます！** あなたのパソコンが、今この瞬間、**Webサーバー**になりました。

---

## 🌐 ブラウザでアクセスして感動体験

### 試してみよう1：社員情報API

ブラウザで以下にアクセスしてください：

```
http://localhost:8080/api/internal/employees/1
```

すると、画面にこんな文字が表示されます：

```json
{
  "id": 1,
  "name": "田中太郎",
  "department": "開発部",
  "email": "tanaka@example.com"
}
```

**これがJSON（ジェイソン）というデータ形式です！** 後で詳しく説明します。

### 試してみよう2：天気情報API

次はこちら：

```
http://localhost:8080/api/internal/weather
```

今度は東京の天気情報が出てきます：

```json
{
  "location": "東京",
  "temperature": 25.5,
  "condition": "晴れ",
  "humidity": 60,
  "windSpeed": 3.2
}
```

**これ、実はインターネット越しに外部のお天気サービスに聞いて、データを取ってきてます。** すごくないですか？

### 試してみよう3：統合お助けAPI（メインディッシュ）

そして、今回の主役がこちら：

```
http://localhost:8080/api/v1/morning-check/1
```

すると...

```json
{
  "employeeName": "田中太郎",
  "department": "開発部",
  "weatherInfo": "晴れ、気温25.5℃、湿度60%、風速3.2m/s",
  "morningMessage": "田中太郎さん、おはようございます！開発部に所属されているんですね。今日の東京の天気は【晴れ】ですよ（気温25.5℃）。今日も1日頑張りましょう！",
  "timestamp": "2025-01-15 08:30:00"
}
```

**感動してください！** たった1つのURLにアクセスしただけなのに、裏では：

1. 社員情報APIに「ID=1の人の情報教えて」と聞きに行き
2. 天気APIに「今の天気教えて」と聞きに行き
3. 天気APIは外部のOpen-Meteoサービスに聞きに行き
4. 集まった情報を組み合わせて、心温まるメッセージを作ってくれました

**これが「APIの連鎖」です！**

---

## 📦 JSONって何？お弁当箱に例えると

`{"name": "田中太郎"}` こういう形式を**JSON（ジェイソン）**と言います。

### お弁当箱に例えると

普通のお弁当箱を想像してください。

```
┌─────────────────────┐
│  ご飯    │  唐揚げ   │
│  卵焼き  │  ブロッコリー │
└─────────────────────┘
```

これをお友達に渡すとき、「この仕切りの左上がご飯だよ」って口頭で説明するのは面倒ですよね。

そこで、**ラベルを貼ります**：

```
┌─────────────────────┐
│ [ご飯]     │ [メイン]  │
│  白米      │  唐揚げ   │
│            │           │
│ [副菜1]    │ [副菜2]   │
│  卵焼き    │ ブロッコリー│
└─────────────────────┘
```

これなら誰が見ても分かります。

**JSONはこの「ラベル付きお弁当箱」の考え方です。**

```json
{
  "ご飯": "白米",
  "メイン": "唐揚げ",
  "副菜1": "卵焼き",
  "副菜2": "ブロッコリー"
}
```

- **`{` と `}`** が お弁当箱の枠
- **`"ご飯"`** がラベル（これを「キー」と呼びます）
- **`"白米"`** が中身（これを「値」と呼びます）

プログラム同士がデータをやり取りする時、この**ラベル付きお弁当箱（JSON）**に詰めて送り合います。

---

## 🔗 APIの連鎖を見てみよう

もう一度、`http://localhost:8080/api/v1/morning-check/1` にアクセスした時に**裏で何が起きているか**を見てみましょう。

### 舞台裏の会話

```
【あなた】
↓「ID=1の人の朝の挨拶が欲しいです」
↓
【統合お助けAPI】
「了解！まず社員情報が必要だな...」
↓
↓「ID=1の社員情報ください」（HTTP通信）
↓
【社員情報API】
「はい、田中太郎さんですね」
↓ JSONで返信
↓
【統合お助けAPI】
「次は天気情報だ...」
↓
↓「今の天気教えてください」（HTTP通信）
↓
【天気API】
「ちょっと待ってね、外部に聞いてくる」
↓
↓「東京の天気教えてください」（インターネット越しHTTP通信）
↓
【Open-Meteo（外部サービス）】
「晴れ、25.5℃です」
↓ JSONで返信
↓
【天気API】
「日本語に直して...晴れ、25.5℃ですよ」
↓ JSONで返信
↓
【統合お助けAPI】
「よし、両方揃った！組み合わせて素敵なメッセージを作ろう」
↓ JSONで返信
↓
【あなた】
「田中太郎さん、おはようございます！...」を受け取る
```

**これが「APIチェーン」「APIオーケストレーション」と呼ばれるものです。**

---

## 🤔 なぜプログラムからプログラムを呼ぶの？

「全部1つのプログラムで作ればいいじゃん」と思いましたか？

良い質問です！でも、APIで分けることには**たくさんのメリット**があります。

### メリット1：分業できる

**カレー作りの例に戻ります。**

- 肉屋さんは肉のプロ
- 八百屋さんは野菜のプロ
- あなたは料理のプロ

それぞれが得意なことに集中できます。

プログラムも同じ。

- 社員情報APIは社員データだけを管理
- 天気APIは天気データだけを管理
- 統合APIはそれらを組み合わせるだけ

**役割が明確だと、メンテナンスしやすい！**

### メリット2：再利用できる

社員情報APIは、今回の「朝の挨拶」だけじゃなく：

- 「給与計算システム」からも呼べる
- 「勤怠管理システム」からも呼べる
- 「社員名簿アプリ」からも呼べる

**1回作れば、いろんなところで使い回せます。**

### メリット3：独立して開発できる

天気APIの中身を変えたい時：

- 他のAPIを止める必要なし
- 他のプログラムに影響を与えない
- 天気APIだけ改善すればOK

**お店を改装しても、他のお店は営業できる感じです。**

### メリット4：外部サービスと連携できる

今回、Open-Meteoという外部サービスを使いました。

- 自分で天気予報システムを作る必要なし
- プロが作った正確なデータが使える
- 自分は「組み合わせる」ことに集中できる

**これが現代のシステム開発です。**

---

## 🎓 もっと深く知りたい人へ

### コードを読んでみよう

このプロジェクトのコードには、**人間味のあるコメント**をたくさん書いてあります。

特に注目してほしいファイル：

1. **`MorningCheckService.java`**
   - APIオーケストレーションの心臓部
   - RestTemplateで他のAPIを呼び出している部分に注目

2. **`WeatherService.java`**
   - 外部APIを呼び出して、データを整形している様子が見れます

3. **`MorningCheckController.java`**
   - ブラウザからのリクエストを受け取る窓口

### H2データベースを覗いてみよう

ブラウザで以下にアクセス：

```
http://localhost:8080/h2-console
```

ログイン情報：
- **JDBC URL**: `jdbc:h2:mem:testdb`
- **User Name**: `sa`
- **Password**: （空欄）

「Connect」をクリックすると、データベースの中身が見れます！

左側の「EMPLOYEES」テーブルをクリックして、「Run」ボタンを押すと、社員データが表示されます。

---

## 🎉 おめでとうございます！

ここまで読んで、実際に動かしてみたあなたは、もう**API連携の基本**を理解しています。

次はぜひ：

- 社員データを増やしてみる（`data.sql`を編集）
- 新しいAPIエンドポイントを追加してみる
- 別の外部APIサービスを使ってみる

プログラミングは**作って、壊して、また作る**の繰り返しです。

失敗を恐れず、どんどん実験してみてください！

---

## 📞 質問・フィードバック

このプロジェクトについて質問があれば、GitHubのIssuesで気軽に聞いてください。

みんなで学び合いましょう！

**Happy Coding! 🚀**
